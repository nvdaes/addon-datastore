# https://github.com/nvaccess/addon-datastore-transform/

name: Create GitHub Discussion

on:
  workflow_call:
  workflow_dispatch:


jobs:
  createGitHubDiscussion:
    runs-on: windows-latest
    permissions:
      discussions: write

    steps:
    - uses: actions/github-script@v6
      with:
        script: |
          const mutation = `mutation {
            createDiscussion(input: {repositoryId: "MDEwOlJlcG9zaXRvcnkyMzI4NDU3MDI=", categoryId: "DIC_kwDODeDxhs4CZ6Q7", body: "The body", title: "The title"}) {
            discussion {
              id 
             }
            }
          }`;
          github.graphql(mutation)
    - name: Create a new GitHub Discussion
      id: create-discussion
      uses: abirismyname/create-discussion@v1.1.0
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}      
      with:
        title: Feelings
        body: |
          Let's talk!
        repository-id: 'MDEwOlJlcG9zaXRvcnkyMzI4NDU3MDI='
        category-id: 'DIC_kwDODeDxhs4CZ6Q7'
    - name: Print discussion url and id
      run: |
        echo discussion-id: ${{steps.create-discussion.outputs.discussion-id}} 
        echo discussion-url: ${{steps.create-discussion.outputs.discussion-url}}             